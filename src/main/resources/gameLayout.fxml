<?xml version="1.0" encoding="UTF-8"?>

<?import com.comp2042.GameOverPanel?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.Group?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>
<?import java.net.URL?>

<StackPane fx:controller="com.comp2042.GuiController"
           xmlns:fx="http://javafx.com/fxml"
           alignment="CENTER">

    <children>
        <!-- Whole console cluster in the middle -->
        <VBox alignment="CENTER" spacing="30.0">
            <padding>
                <Insets top="40.0" right="0.0" bottom="40.0" left="0.0"/>
            </padding>

            <children>

                <!-- ================= TOP ROW: HOLD | BOARD | NEXT ================= -->
                <HBox alignment="CENTER" spacing="40.0">
                    <children>

                        <!-- ===== LEFT COLUMN: HOLD (top) + SCORE (bottom) ===== -->
                        <VBox alignment="TOP_CENTER"
                              spacing="10.0"
                              prefWidth="210.0"
                              fillWidth="false">
                            <children>

                                <!-- HOLD (same size style as each NEXT box) -->
                                <VBox alignment="TOP_CENTER" spacing="6.0">
                                    <children>
                                        <Label text="HOLD (C)" styleClass="nextBrickLabel"/>

                                        <StackPane styleClass="panel-frame-square">
                                            <padding>
                                                <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
                                            </padding>
                                            <children>
                                                <GridPane fx:id="holdBrickPanel"
                                                          hgap="1" vgap="1"
                                                          prefWidth="80.0" prefHeight="80.0"
                                                          styleClass="nextBrick"/>
                                            </children>
                                        </StackPane>
                                    </children>
                                </VBox>

                                <!-- Spacer pushes score panel down so it lines up with board bottom -->
                                <Region VBox.vgrow="ALWAYS"/>

                                <!-- SCORE / LEVEL / LINES / COMBO panel -->
                                <StackPane styleClass="panel-frame-square score-panel">
                                    <padding>
                                        <Insets top="10.0" right="18.0" bottom="10.0" left="18.0"/>
                                    </padding>
                                    <children>
                                        <VBox spacing="6.0" alignment="TOP_LEFT">
                                            <children>
                                                <Text text="SCORE" styleClass="hud-value hud-subtitle"/>
                                                <Text fx:id="scoreText" text="Score 0" styleClass="hud-value"/>

                                                <Text text="LEVEL" styleClass="hud-value hud-subtitle"/>
                                                <Text fx:id="levelText" text="Level 1" styleClass="hud-value"/>

                                                <Text text="LINES" styleClass="hud-value hud-subtitle"/>
                                                <Text fx:id="linesText" text="Lines 0" styleClass="hud-value"/>

                                                <Text text="COMBO" styleClass="hud-value hud-subtitle"/>
                                                <Text fx:id="comboText" text="Combo x0" styleClass="hud-value"/>
                                            </children>
                                        </VBox>
                                    </children>
                                </StackPane>

                            </children>
                        </VBox>

                        <!-- =================== CENTRE: MAIN BOARD =================== -->
                        <StackPane alignment="CENTER">
                            <children>
                                <Group>
                                    <children>

                                        <!-- Board frame -->
                                        <BorderPane fx:id="gameBoard" styleClass="gameBoard">
                                            <center>
                                                <GridPane fx:id="gamePanel"
                                                          hgap="1" vgap="1"
                                                          layoutY="30.0" layoutX="40.0"/>
                                            </center>
                                        </BorderPane>

                                        <!-- Falling brick -->
                                        <GridPane fx:id="brickPanel" vgap="1" hgap="1"/>

                                        <!-- Notifications + GameOverPanel -->
                                        <Group fx:id="groupNotification" layoutX="14.0" layoutY="203.0">
                                            <children>
                                                <VBox alignment="CENTER">
                                                    <GameOverPanel fx:id="gameOverPanel"/>
                                                </VBox>
                                            </children>
                                        </Group>

                                        <!-- Pause overlay -->
                                        <Pane fx:id="pauseOverlay"
                                              layoutX="0.0" layoutY="0.0"
                                              visible="false"
                                              style="-fx-background-color: rgba(0,0,0,0.5);">
                                            <children>
                                                <VBox alignment="CENTER" spacing="10.0"
                                                      layoutX="60.0" layoutY="180.0">
                                                    <Label text="PAUSED" styleClass="gameOverStyle"/>

                                                    <Button fx:id="resumeButton"
                                                            text="Resume"
                                                            styleClass="ipad-dark-grey"/>

                                                    <Button fx:id="restartButton"
                                                            text="Restart"
                                                            styleClass="ipad-dark-grey"/>

                                                    <Button fx:id="pauseMenuButton"
                                                            text="Main Menu"
                                                            styleClass="ipad-dark-grey"/>
                                                </VBox>
                                            </children>
                                        </Pane>

                                    </children>
                                </Group>
                            </children>
                        </StackPane>

                        <!-- ===== RIGHT COLUMN: 3Ã— NEXT in one tall frame ===== -->
                        <VBox alignment="TOP_CENTER" spacing="8.0">
                            <padding>
                                <Insets top="10.0" right="0.0" bottom="0.0" left="0.0"/>
                            </padding>
                            <children>
                                <Label text="NEXT" styleClass="nextBrickLabel"/>

                                <StackPane styleClass="next-column-frame">
                                    <padding>
                                        <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
                                    </padding>
                                    <children>
                                        <VBox alignment="CENTER" spacing="10.0">
                                            <children>
                                                <GridPane fx:id="nextBrickPanelTop"
                                                          hgap="1" vgap="1"
                                                          prefWidth="80.0" prefHeight="80.0"
                                                          styleClass="nextBrick"/>

                                                <GridPane fx:id="nextBrickPanelMid"
                                                          hgap="1" vgap="1"
                                                          prefWidth="80.0" prefHeight="80.0"
                                                          styleClass="nextBrick"/>

                                                <GridPane fx:id="nextBrickPanelBottom"
                                                          hgap="1" vgap="1"
                                                          prefWidth="80.0" prefHeight="80.0"
                                                          styleClass="nextBrick"/>
                                            </children>
                                        </VBox>
                                    </children>
                                </StackPane>
                            </children>
                        </VBox>

                    </children>
                </HBox>

                <!-- Bottom HUD kept for controller, hidden from player -->
                <HBox alignment="CENTER" spacing="30.0"
                      visible="false" managed="false">
                    <children>
                        <VBox spacing="5.0" alignment="TOP_LEFT">
                            <children>
                                <Text fx:id="modeText"
                                      text="Mode: Classic"
                                      styleClass="hud-value hud-title"/>

                                <Text fx:id="modeHintText"
                                      text="Classic: standard Tetris rules."
                                      styleClass="hud-value hud-subtitle"/>

                                <Text fx:id="timerText"
                                      text="Time 00:00"
                                      styleClass="hud-value"/>

                                <Text fx:id="progressText"
                                      text=""
                                      styleClass="hud-value"/>

                                <Text fx:id="dangerText"
                                      text="DANGER!"
                                      visible="false"
                                      styleClass="dangerText hud-value hud-danger"/>
                            </children>
                        </VBox>
                    </children>
                </HBox>

            </children>
        </VBox>
    </children>

    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
