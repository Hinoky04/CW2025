<?xml version="1.0" encoding="UTF-8"?>

<?import com.comp2042.GameOverPanel?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.Group?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>
<?import java.net.URL?>

<StackPane fx:controller="com.comp2042.GuiController"
           xmlns:fx="http://javafx.com/fxml">

    <children>
        <BorderPane prefWidth="900.0" prefHeight="700.0">
            <!-- 全局一点 padding，让左右布局不贴边 -->
            <padding>
                <Insets top="20.0" bottom="20.0" left="30.0" right="30.0"/>
            </padding>

            <!-- ========== LEFT: HOLD + SCORE PANEL ========== -->
            <left>
                <VBox alignment="CENTER" spacing="30.0">
                    <children>

                        <!-- HOLD -->
                        <VBox alignment="TOP_CENTER" spacing="8.0">
                            <children>
                                <Label text="HOLD (C)" styleClass="nextBrickLabel"/>

                                <!-- 外框 -->
                                <StackPane styleClass="panel-frame">
                                    <padding>
                                        <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
                                    </padding>
                                    <children>
                                        <GridPane fx:id="holdBrickPanel"
                                                  hgap="1" vgap="1"
                                                  prefWidth="96.0" prefHeight="96.0"
                                                  styleClass="nextBrick"/>
                                    </children>
                                </StackPane>
                            </children>
                        </VBox>

                        <!-- SCORE / LEVEL / LINES / COMBO -->
                        <VBox spacing="6.0" alignment="TOP_LEFT" styleClass="hud-box">
                            <padding>
                                <Insets top="10.0" right="16.0" bottom="10.0" left="16.0"/>
                            </padding>
                            <children>
                                <Text text="SCORE" styleClass="hud-value hud-subtitle"/>
                                <Text fx:id="scoreText" text="Score 0" styleClass="hud-value"/>

                                <Text text="LEVEL" styleClass="hud-value hud-subtitle"/>
                                <Text fx:id="levelText" text="Level 1" styleClass="hud-value"/>

                                <Text text="LINES" styleClass="hud-value hud-subtitle"/>
                                <Text fx:id="linesText" text="Lines 0" styleClass="hud-value"/>

                                <Text text="COMBO" styleClass="hud-value hud-subtitle"/>
                                <Text fx:id="comboText" text="Combo x0" styleClass="hud-value"/>
                            </children>
                        </VBox>

                    </children>
                </VBox>
            </left>

            <!-- ========== CENTER: BOARD + BRICK + OVERLAYS ========== -->
            <center>
                <StackPane alignment="CENTER">
                    <children>
                        <Group>
                            <children>

                                <!-- 主棋盘外框 -->
                                <BorderPane fx:id="gameBoard" styleClass="gameBoard">
                                    <center>
                                        <!-- 10xN grid -->
                                        <GridPane fx:id="gamePanel"
                                                  hgap="1" vgap="1"
                                                  layoutY="30.0" layoutX="40.0"/>
                                    </center>
                                </BorderPane>

                                <!-- 掉落中的方块 -->
                                <GridPane fx:id="brickPanel" vgap="1" hgap="1"/>

                                <!-- 通知 + GameOverPanel -->
                                <Group fx:id="groupNotification" layoutX="14.0" layoutY="203.0">
                                    <children>
                                        <VBox alignment="CENTER">
                                            <GameOverPanel fx:id="gameOverPanel"/>
                                        </VBox>
                                    </children>
                                </Group>

                                <!-- 暂停遮罩 -->
                                <Pane fx:id="pauseOverlay"
                                      layoutX="0.0" layoutY="0.0"
                                      prefWidth="400.0" prefHeight="500.0"
                                      visible="false"
                                      style="-fx-background-color: rgba(0,0,0,0.5);">
                                    <children>
                                        <VBox alignment="CENTER" spacing="10.0" layoutX="60.0" layoutY="180.0">
                                            <Label text="PAUSED" styleClass="gameOverStyle"/>

                                            <Button fx:id="resumeButton"
                                                    text="Resume"
                                                    styleClass="ipad-dark-grey"/>

                                            <Button fx:id="restartButton"
                                                    text="Restart"
                                                    styleClass="ipad-dark-grey"/>

                                            <Button fx:id="pauseMenuButton"
                                                    text="Main Menu"
                                                    styleClass="ipad-dark-grey"/>
                                        </VBox>
                                    </children>
                                </Pane>

                            </children>
                        </Group>
                    </children>
                </StackPane>
            </center>

            <!-- ========== RIGHT: 3-NEXT QUEUE ========== -->
            <right>
                <VBox alignment="CENTER" spacing="16.0">
                    <children>
                        <Label text="NEXT" styleClass="nextBrickLabel"/>

                        <!-- NEXT 1 -->
                        <StackPane styleClass="panel-frame">
                            <padding>
                                <Insets top="8.0" right="8.0" bottom="8.0" left="8.0"/>
                            </padding>
                            <children>
                                <GridPane fx:id="nextBrickPanelTop"
                                          hgap="1" vgap="1"
                                          prefWidth="80.0" prefHeight="80.0"
                                          styleClass="nextBrick"/>
                            </children>
                        </StackPane>

                        <!-- NEXT 2 -->
                        <StackPane styleClass="panel-frame">
                            <padding>
                                <Insets top="8.0" right="8.0" bottom="8.0" left="8.0"/>
                            </padding>
                            <children>
                                <GridPane fx:id="nextBrickPanelMid"
                                          hgap="1" vgap="1"
                                          prefWidth="80.0" prefHeight="80.0"
                                          styleClass="nextBrick"/>
                            </children>
                        </StackPane>

                        <!-- NEXT 3 -->
                        <StackPane styleClass="panel-frame">
                            <padding>
                                <Insets top="8.0" right="8.0" bottom="8.0" left="8.0"/>
                            </padding>
                            <children>
                                <GridPane fx:id="nextBrickPanelBottom"
                                          hgap="1" vgap="1"
                                          prefWidth="80.0" prefHeight="80.0"
                                          styleClass="nextBrick"/>
                            </children>
                        </StackPane>
                    </children>
                </VBox>
            </right>

            <!-- ========== BOTTOM: MODE / TIMER / PROGRESS / BEST / DANGER ========== -->
            <bottom>
                <HBox alignment="CENTER" spacing="40.0">
                    <children>
                        <VBox spacing="5.0" alignment="TOP_LEFT" styleClass="hud-box">
                            <padding>
                                <Insets top="10.0" right="20.0" bottom="10.0" left="20.0"/>
                            </padding>
                            <children>
                                <Text fx:id="modeText" text="Mode: Classic" styleClass="hud-value hud-title"/>

                                <Text fx:id="modeHintText"
                                      text="Classic: standard Tetris rules."
                                      styleClass="hud-value hud-subtitle"/>

                                <Text fx:id="timerText" text="Time 00:00" styleClass="hud-value"/>

                                <!-- Progress: Survival/Rush 用 -->
                                <Text fx:id="progressText" text="" styleClass="hud-value"/>

                                <!-- Best Score / Time -->
                                <Text fx:id="bestText" text="Best Score 0" styleClass="hud-value"/>

                                <!-- Danger 标记 -->
                                <Text fx:id="dangerText"
                                      text="DANGER!"
                                      visible="false"
                                      styleClass="dangerText hud-value hud-danger"/>
                            </children>
                        </VBox>
                    </children>
                </HBox>
            </bottom>
        </BorderPane>
    </children>

    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
