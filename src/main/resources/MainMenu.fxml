<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import java.net.URL?>

<!-- Modern main menu with improved layout and visual design -->
<StackPane xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.comp2042.controllers.MainMenuController">
    
    <!-- Main content container -->
    <VBox alignment="CENTER" spacing="40" styleClass="menu-container" pickOnBounds="true">
        <padding>
            <Insets top="60" right="40" bottom="60" left="40"/>
        </padding>

        <!-- Title section with enhanced styling -->
        <VBox alignment="CENTER" spacing="8" styleClass="title-section">
            <Label fx:id="titleLabel"
                   text="TetrisJFX"
                   styleClass="menu-title"/>
            <Label text="Choose Your Challenge"
                   styleClass="menu-subtitle"/>
        </VBox>

        <!-- Game mode buttons container -->
        <VBox alignment="CENTER" spacing="16" styleClass="button-container">
            <Button fx:id="classicButton"
                    text="Classic"
                    onAction="#handleClassic"
                    styleClass="menu-button"/>
            
            <Button fx:id="survivalButton"
                    text="Survival"
                    onAction="#handleSurvival"
                    styleClass="menu-button"/>
            
            <Button fx:id="hyperButton"
                    text="Invisible"
                    onAction="#handleHyper"
                    styleClass="menu-button"/>
            
            <Button fx:id="rushButton"
                    text="Rush 40"
                    onAction="#handleRush"
                    styleClass="menu-button"/>
        </VBox>

        <!-- Settings and Quit buttons separated at bottom -->
        <VBox alignment="CENTER" spacing="12">
            <Button fx:id="settingsButton"
                    text="Settings"
                    onAction="#handleSettings"
                    styleClass="menu-button"/>
            
            <Button fx:id="quitButton"
                    text="Quit"
                    onAction="#handleQuit"
                    styleClass="menu-button-quit"/>
        </VBox>
    </VBox>

    <!-- Tutorial overlay (shown on first visit) - Centered modal page -->
    <StackPane fx:id="tutorialOverlay"
               visible="false"
               alignment="CENTER"
               mouseTransparent="true"
               pickOnBounds="false">
        <!-- Semi-transparent background overlay covering entire screen -->
        <Region fx:id="tutorialBackground"
                style="-fx-background-color: rgba(0,0,0,0.85);"
                maxWidth="Infinity"
                maxHeight="Infinity"
                mouseTransparent="true"/>
        
        <!-- Centered tutorial panel - appears as a modal page -->
        <VBox alignment="CENTER" spacing="20.0" styleClass="tutorial-panel" maxWidth="900" maxHeight="700">
            <padding>
                <Insets top="40.0" right="40.0" bottom="40.0" left="40.0"/>
            </padding>
            
            <children>
                <Label text="HOW TO PLAY" styleClass="tutorial-title"/>
                
                <ScrollPane fitToWidth="true" styleClass="maintenance-scroll">
                    <VBox alignment="CENTER_LEFT" spacing="12.0" styleClass="tutorial-content">
                        <Label text="Game Modes:" styleClass="tutorial-section"/>
                        <Label text="• Classic: Traditional Tetris gameplay with standard speed progression" styleClass="tutorial-text"/>
                        <Label text="• Survival: Endless mode with increasing difficulty and garbage lines" styleClass="tutorial-text"/>
                        <Label text="• Invisible: Faster gameplay with dimmed/transparent landed blocks" styleClass="tutorial-text"/>
                        <Label text="• Rush 40: Clear 40 lines as fast as possible - race against time!" styleClass="tutorial-text"/>
                        
                        <Label text="Objective:" styleClass="tutorial-section"/>
                        <Label text="• Clear lines by filling horizontal rows" styleClass="tutorial-text"/>
                        <Label text="• Complete lines disappear and you score points" styleClass="tutorial-text"/>
                        <Label text="• Game ends when blocks reach the top" styleClass="tutorial-text"/>
                        
                        <Label text="Controls:" styleClass="tutorial-section"/>
                        <Label text="• ↑ (Up Arrow): Rotate piece" styleClass="tutorial-text"/>
                        <Label text="• ← → (Left/Right Arrows): Move piece left or right" styleClass="tutorial-text"/>
                        <Label text="• ↓ (Down Arrow): Drop piece faster" styleClass="tutorial-text"/>
                        <Label text="• Space: Hard drop (instant drop)" styleClass="tutorial-text"/>
                        <Label text="• C: Hold current piece" styleClass="tutorial-text"/>
                        <Label text="• P / ESC: Pause game" styleClass="tutorial-text"/>
                        
                        <Label text="Tips:" styleClass="tutorial-section"/>
                        <Label text="• The shadow shows where the piece will land" styleClass="tutorial-text"/>
                        <Label text="• Clear multiple lines at once for bonus points" styleClass="tutorial-text"/>
                        <Label text="• Plan ahead using the NEXT preview" styleClass="tutorial-text"/>
                    </VBox>
                </ScrollPane>
                
                <Button fx:id="tutorialCloseButton"
                        text="Got it! Let's Play"
                        styleClass="pause-button"/>
            </children>
        </VBox>
    </StackPane>

    <!-- Info buttons (bottom left) -->
    <HBox alignment="BOTTOM_LEFT" spacing="10" StackPane.alignment="BOTTOM_LEFT" pickOnBounds="false">
        <StackPane.margin>
            <Insets bottom="20" left="20"/>
        </StackPane.margin>
        <Button fx:id="tutorialButton"
                text="?"
                styleClass="maintenance-button"
                onAction="#handleTutorial"/>
        <Button fx:id="maintenanceButton"
                styleClass="maintenance-button"
                onAction="#handleMaintenance"/>
    </HBox>

    <!-- Maintenance overlay (shown when button is clicked) -->
    <StackPane fx:id="maintenanceOverlay"
               visible="false"
               alignment="CENTER"
               mouseTransparent="true"
               pickOnBounds="true">
        <!-- Semi-transparent background overlay covering entire screen -->
        <Region style="-fx-background-color: rgba(0,0,0,0.85);"
                maxWidth="Infinity"
                maxHeight="Infinity"/>
        
        <!-- Centered maintenance panel -->
        <VBox alignment="CENTER" spacing="20.0" styleClass="tutorial-panel" maxWidth="900" maxHeight="700">
            <padding>
                <Insets top="40.0" right="40.0" bottom="40.0" left="40.0"/>
            </padding>
            
            <children>
                <Label text="MAINTENANCE LOG" styleClass="tutorial-title"/>
                
                <ScrollPane fitToWidth="true" styleClass="maintenance-scroll">
                    <VBox fx:id="maintenanceContent"
                          alignment="CENTER_LEFT"
                          spacing="6.0"
                          styleClass="tutorial-content">
                        <!-- Content will be populated by controller -->
                    </VBox>
                </ScrollPane>
                
                <Button fx:id="maintenanceCloseButton"
                        text="Close"
                        styleClass="pause-button"/>
            </children>
        </VBox>
    </StackPane>

    <!-- Reuse the same stylesheet as the game scene. -->
    <stylesheets>
        <URL value="@window_style.css"/>
    </stylesheets>
</StackPane>
